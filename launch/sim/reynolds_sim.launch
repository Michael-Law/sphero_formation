<launch>
	<!-- Set the arguments -->
	<arg name="num" default="4"/>  <!-- Number of robots -->
	<arg name="robot_name" default="robot"/>
	<arg name="map_name" default="empty_3x3"/>  <!-- Name of the simulation map -->
	<!-- Config file with initial velocities for each Sphero -->
	<arg name="filename" default="$(find sphero_formation)/cfg/sphero_init_vel.cfg"/>

	<arg name="map_world" default="$(find sphero_formation)/resources/sim/$(arg map_name)_$(arg num).world"/>
	<arg name="map_yaml" default="$(find sphero_formation)/resources/maps/$(arg map_name).yaml"/>

	<!-- Start Reynolds controller nodes launcher. -->
	<node pkg="sphero_formation" type="reynolds_launch.sh" name="Reynolds_launcher" args="$(arg num) $(arg filename) $(arg robot_name)" output="screen"/>

	<!-- Start nearest_search node: search for other Spheros in range. -->
	<node pkg="sphero_formation" type="nearest_search.py" name="search" output="screen">
		<param name="num_of_robots" type="int" value="$(arg num)"/>
		<param name="robot_name" type="string" value="$(arg robot_name)"/>
	</node>

	<!-- Start Stage simulator -->
	<node pkg="stage_ros" type="stageros" name="simulator" args="$(arg map_world)"/>

	<!-- Start simulation_tf node: provide tf transforms for simulation-->
	<node pkg="sphero_formation" type="simulation_tf.py" name="tf_server">
		<param name="num_of_robots" type="int" value="$(arg num)"/>
	</node>

	<!-- Start map server -->
	<node pkg="map_server" type="map_server" args="$(arg map_yaml)" name="map_server"/>

	<!-- Start rviz. -->
	<node pkg="rviz" type="rviz" name="rviz" args="-d $(find sphero_formation)/launch/sim/sphero_sim.rviz"/>
</launch>